swagger: '2.0'
info:
  version: '0.4'
  title: RelayAccess
  description: API for accessing github.com/practable/relay websocket relay. Note scheme http and host localhost due to running behind proxy
  contact:
    email: timothy.d.drysdale@gmail.com
    name: Timothy Drysdale
    url: https://github.com/timdrysdale
host: localhost
basePath: /
securityDefinitions: {}
schemes:
- http
consumes:
- application/json
produces:
- application/json
securityDefinitions:
  Bearer:
    type: apiKey
    name: Authorization
    in: header 
paths:
  /bids/allowed:
    get:
      description: Get a list of all currently-allowed bids (booking ids) with an ongoing or recent live connection
      summary: Get a list of all currently-allowed bids
      operationId: listAllowed
      deprecated: False
      produces:
      - application/json
      security:
        - Bearer: []
      responses:
        200:
          description: Current or recently in-use allowed bids
          schema:
            $ref: '#/definitions/Bids'
        401:
          description: Unauthorized
          schema: {}
  /bids/deny:
    get:
      description: Get a list of all currently-denied bids
      summary: Get a list of all currently-denied bids
      operationId: listDenied
      deprecated: False
      produces:
      - application/json
      security:
        - Bearer: []
      responses:
        200:
          description: List of current denied bids
          schema:
            $ref: '#/definitions/Bids'
        401:
          description: Unauthorized
          schema: {}  
    post:
      description: Refuse sessions to new connections using tokens with the bid(s) (booking ids), and disconnect any current sessions immediately. 
      summary: Refuse sessions to new connections using tokens with the bid(s) (booking ids), and disconnect any current sessions immediately.
      operationId: deny
      deprecated: false
      consumes:
      - application/json
      parameters:
        - name: bid
          in: query
          type: string
          required: false
        - name: bids
          in: body
          schema:
            $ref: '#/definitions/Bids'
      security:
        - Bearer: []  
      responses:
        204:
          description: The bids were denied successfully.
          schema: {}
        401:
          description: Unauthorized
          schema: {}
          
  /session/{session_id}:
    post:
      description: access the specified session
      summary: session
      operationId: session
      deprecated: false
      produces:
      - application/json
      parameters:
      - name: session_id
        in: path
        type: string
        description: Session identification code
        required: true
      security:
        - Bearer: []  
      responses:
        200:
          description: ''
          schema:
            type: object
            properties:
              uri:
                type: string
          examples:
            text/plain: {"code":"b142eb22-1f16-4af1-ba14-e70a7afcbcc2"}
          headers: {}
        401:
          description: Unauthorized
          schema: {}
          
definitions:
  Bids:
    title: Set of booking IDs (bids)
    type: object
    properties:
      bids:
        description: list bids in string format
        type: array
        items:
          type: string
    required:
    - bids
